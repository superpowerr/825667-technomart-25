var writeUsPopup=document.querySelector(".modal-write-us"),mapPopup=document.querySelector(".modal-map"),cartPopup=document.querySelector(".modal-cart"),writeUs=document.querySelector(".contacts .button"),form=document.querySelector(".modal-write-us form"),nameField=document.querySelector("#user-name"),emailField=document.querySelector("#user-email"),commentField=document.querySelector("#user-comment"),map=document.querySelector(".contacts a:first-of-type"),addToCartButtons=document.querySelectorAll(".item-cover a"),isStorageSupport=!0,storageName="",storageEmail="",tabsLink=document.querySelectorAll(".services-item a"),currentTab=document.querySelector(".services-item .active"),currentTabContent=document.querySelector(".services-info-wrapper .active"),currentSlide=0,slides=document.querySelectorAll(".offers-slider section"),radio=document.querySelectorAll(".slider-controls span"),scale=document.querySelector(".range-filter .scale");try{storageName=localStorage.getItem("name"),storageEmail=localStorage.getItem("email")}catch(e){isStorageSupport=!1}var openModal=function(e,t){e.addEventListener("click",function(e){e.preventDefault(),t.classList.add("modal-show"),t===writeUsPopup&&formValidate(writeUsPopup),closePopup()})},formValidate=function(t){nameField.focus(),storageName&&(nameField.value=storageName,emailField.focus()),storageEmail&&(emailField.value=storageEmail,commentField.focus()),!storageName&&storageEmail&&nameField.focus(),form.addEventListener("submit",function(e){nameField.value&&emailField.value?isStorageSupport&&(localStorage.setItem("name",nameField.value),localStorage.setItem("email",emailField.value)):(e.preventDefault(),t.classList.remove("modal-error"),t.offsetWidth=t.offsetWidth,t.classList.add("modal-error"))})},closePopup=function(){var e=document.querySelector(".modal-show .modal-close"),t=document.querySelector(".modal-show");e.addEventListener("click",function(e){e.preventDefault(),t.classList.remove("modal-error"),t.classList.remove("modal-show")}),window.addEventListener("keydown",function(e){27===e.keyCode&&(e.preventDefault(),t.classList.remove("modal-error"),t.classList.remove("modal-show"))}),t===cartPopup&&document.querySelector(".modal-cart .button-white").addEventListener("click",function(e){e.preventDefault(),t.classList.remove("modal-show")})};if(writeUs&&openModal(writeUs,writeUsPopup),map&&openModal(map,mapPopup),tabsLink&&tabsLink.forEach(function(o){o.addEventListener("click",function(e){event.preventDefault(),location.hash=this.hash;var t=document.querySelector(this.hash);t.classList.add("active"),o.classList.add("active"),currentTab!==o&&(currentTab.classList.remove("active"),currentTab=o,currentTabContent.classList.remove("active"),currentTabContent=t)})}),addToCartButtons&&addToCartButtons.forEach(function(e){openModal(e,cartPopup)}),slides){var firstSlide=document.querySelector(".slider-controls span:nth-child(1)"),secondSlide=document.querySelector(".slider-controls span:nth-child(2)"),nextSlide=document.querySelector(".offers-slider .next-slide"),previousSlide=document.querySelector(".offers-slider .previous-slide"),showSlides=function(e){if(e>slides.length-1)e=0;else if(e<0)e=slides.length-1;else if(e===currentSlide)return;i=0,slides[currentSlide].classList.remove("active"),slides[e].classList.add("active"),radio[currentSlide].classList.remove("active"),radio[e].classList.add("active"),currentSlide=e};firstSlide&&secondSlide&&(firstSlide.addEventListener("click",function(e){e.preventDefault(),showSlides(0)}),secondSlide.addEventListener("click",function(e){e.preventDefault(),showSlides(1)}));var showNextSlide=function(){showSlides(currentSlide+1)},showPreviousSlide=function(){showSlides(currentSlide-1)};nextSlide&&previousSlide&&(nextSlide.addEventListener("click",function(e){e.preventDefault(),showNextSlide()}),previousSlide.addEventListener("click",function(e){e.preventDefault(),showPreviousSlide()}))}if(scale){var MIN_OFFSET=18,bar=document.querySelector(".range-filter .bar"),toggleMin=document.querySelector(".range-filter .toggle-min"),toggleMax=document.querySelector(".range-filter .toggle-max"),minInput=document.querySelector("#filter-min-price"),maxInput=document.querySelector("#filter-max-price"),rangeEnd=scale.offsetWidth,min=parseInt(getComputedStyle(toggleMin).left),max=parseInt(getComputedStyle(toggleMax).left),getLeftSide=function(e){return e.getBoundingClientRect().left},scaleStart=getLeftSide(scale);toggleMin.onmousedown=function(e){var o=-(e.clientX-getLeftSide(toggleMin));document.onmousemove=function(e){var t=e.clientX+o-scaleStart+20;t<MIN_OFFSET&&(t=MIN_OFFSET),t>max-toggleMin.offsetWidth/2&&(t=max-toggleMin.offsetWidth/2),min=t,toggleMin.style.left=min+"px",bar.style.width=max-min+"px",bar.style.left=min+"px",minInput.value=MIN_OFFSET<t?(min/rangeEnd*minInput.max).toFixed():0},document.onmouseup=function(){document.onmousemove=document.onmouseup=null}},minInput.addEventListener("input",function(e){var t=minInput.value*rangeEnd/minInput.max;t>max-toggleMin.offsetWidth/2&&(t=max-toggleMin.offsetWidth/2),toggleMin.style.left=(min=MIN_OFFSET<t?t:MIN_OFFSET)+"px",bar.style.width=max-min+"px",bar.style.left=min+"px"}),toggleMax.onmousedown=function(e){var o=-(e.clientX-getLeftSide(toggleMax));document.onmousemove=function(e){var t=e.clientX+o-scaleStart+20;t<min+toggleMin.offsetWidth/2&&(t=min+toggleMin.offsetWidth/2),rangeEnd<t&&(t=rangeEnd),max=t,toggleMax.style.left=max+"px",bar.style.width=max-min+"px",maxInput.value=(max/rangeEnd*maxInput.max).toFixed()},document.onmouseup=function(){document.onmousemove=document.onmouseup=null}},maxInput.addEventListener("input",function(e){var t=maxInput.value*rangeEnd/maxInput.max;rangeEnd<t&&(t=rangeEnd),toggleMax.style.left=scaleStart<t-min?(max=t)+"px":(max=scaleStart)+"px",bar.style.width=max-min+"px"})}
